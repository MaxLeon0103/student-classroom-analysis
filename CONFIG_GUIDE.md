# 配置指南 - 学生课堂分析系统

## 📋 目录
1. [环境变量配置](#环境变量配置)
2. [AI服务提供商配置](#ai服务提供商配置)
3. [自定义提示词](#自定义提示词)
4. [Web界面配置](#web界面配置)
5. [高级配置](#高级配置)

## 🔧 环境变量配置

### 1. 创建配置文件
```bash
# 复制示例配置文件
cp env.example .env

# 编辑配置文件
nano .env  # 或使用你喜欢的编辑器
```

### 2. 基本配置项
```env
# AI服务提供商 (openai, baidu, alibaba, tencent)
AI_PROVIDER=openai

# 服务器端口
PORT=3000

# 运行环境
NODE_ENV=development
```

## 🤖 AI服务提供商配置

### OpenAI (推荐)
```env
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_MAX_TOKENS=500
OPENAI_TEMPERATURE=0.7
```

**获取API密钥：**
1. 访问 [OpenAI官网](https://platform.openai.com/)
2. 注册/登录账户
3. 进入API Keys页面
4. 创建新的API密钥

**支持的模型：**
- `gpt-3.5-turbo` (推荐，性价比高)
- `gpt-4` (质量更高，价格更贵)
- `gpt-4-turbo` (最新版本)

### 百度文心一言
```env
BAIDU_API_KEY=your_baidu_api_key
BAIDU_SECRET_KEY=your_baidu_secret_key
```

**获取API密钥：**
1. 访问 [百度智能云](https://cloud.baidu.com/)
2. 开通文心一言服务
3. 获取API Key和Secret Key

### 阿里通义千问
```env
ALIBABA_API_KEY=your_alibaba_api_key
```

**获取API密钥：**
1. 访问 [阿里云](https://www.aliyun.com/)
2. 开通通义千问服务
3. 获取API密钥

### 腾讯混元
```env
TENCENT_API_KEY=your_tencent_api_key
```

**获取API密钥：**
1. 访问 [腾讯云](https://cloud.tencent.com/)
2. 开通混元大模型服务
3. 获取API密钥

## 📝 自定义提示词

### 1. 系统角色提示词
定义AI的基本角色和行为模式：
```env
SYSTEM_PROMPT=你是一名专业的教育评价专家，擅长为学生提供详细、建设性的课堂表现评价。
```

### 2. 主要提示词模板
使用占位符 `{content}` 和 `{rating}`：
```env
MAIN_PROMPT=作为一名教育专家，请根据以下课堂内容和评价等级，生成一份专业、详细的学生课堂表现评价：

课堂内容：{content}
评价等级：{rating}

请从以下几个方面进行评价：
1. 学习态度和参与度
2. 知识掌握情况
3. 思维能力和创新性
4. 团队合作和沟通能力
5. 改进建议

评价要求：
- 语言专业且富有建设性
- 针对性强，具体指出优点和不足
- 提供可操作的建议
- 字数控制在200-300字之间
- 语调积极正面，鼓励学生进步

请直接输出评价内容，不要包含其他格式标记。
```

### 3. 等级特定提示词
为不同评价等级定制特殊提示词：

```env
# 优秀学生
EXCELLENT_PROMPT=该学生表现优秀，请重点突出其优点和值得表扬的地方，同时给出进一步提升的建议。

# 良好学生
GOOD_PROMPT=该学生表现良好，请平衡地评价其优点和需要改进的地方，给出具体的改进建议。

# 一般学生
AVERAGE_PROMPT=该学生表现一般，请指出其不足之处，并给出具体的改进建议和鼓励。

# 待改进学生
POOR_PROMPT=该学生需要改进，请温和地指出问题所在，并给出具体的改进方案和鼓励。
```

### 4. 提示词设计技巧

**好的提示词特点：**
- 明确具体的角色定义
- 清晰的输出格式要求
- 具体的评价维度
- 适当的字数限制
- 积极的语调要求

**示例 - 更详细的提示词：**
```env
MAIN_PROMPT=你是一位经验丰富的教育专家，拥有20年的教学经验。请根据以下信息生成专业的学生评价：

课堂内容：{content}
评价等级：{rating}

评价结构要求：
1. 开头：简要总结学生表现
2. 主体：从以下维度详细分析
   - 学习态度：专注度、主动性、积极性
   - 知识掌握：理解程度、应用能力、记忆效果
   - 思维能力：分析能力、创新思维、逻辑推理
   - 沟通合作：表达能力、团队协作、互动参与
3. 结尾：具体改进建议和鼓励

语言要求：
- 专业术语适当使用
- 语调温和鼓励
- 具体举例说明
- 字数200-300字
- 避免空洞套话

请直接输出评价内容，不要包含标题或格式标记。
```

## 🌐 Web界面配置

### 1. 访问配置页面
启动服务器后，访问：`http://localhost:3000/admin.html`

### 2. 配置功能
- **AI提供商切换**：实时切换不同的AI服务
- **提示词编辑**：可视化编辑所有提示词
- **参数调整**：调整生成参数
- **连接测试**：测试AI服务连接

### 3. 配置保存
- 本地配置：保存到浏览器本地存储
- 服务器配置：通过环境变量持久化

## ⚙️ 高级配置

### 1. 生成参数调优

**Token数量控制：**
```env
OPENAI_MAX_TOKENS=500  # 控制生成文本长度
```

**创造性控制：**
```env
OPENAI_TEMPERATURE=0.7  # 0-2，越高越有创造性
```

**内容长度限制：**
```env
MIN_CONTENT_LENGTH=10   # 最小输入长度
MAX_CONTENT_LENGTH=500  # 最大输入长度
```

### 2. 自定义评价等级
```env
ENABLE_CUSTOM_RATING=true
```

在 `config.js` 中添加自定义等级：
```javascript
ratingPrompts: {
    '优秀': '...',
    '良好': '...',
    '一般': '...',
    '待改进': '...',
    '卓越': '该学生表现卓越，请重点突出其超越同龄人的优秀表现...',
    '需要关注': '该学生需要特别关注，请温和地指出问题并提供详细帮助方案...'
}
```

### 3. 多语言支持
```env
LANGUAGE=zh-CN  # 支持 zh-CN, en-US, ja-JP 等
```

### 4. 缓存配置
```env
ENABLE_CACHE=true
CACHE_DURATION=3600  # 缓存时间（秒）
```

## 🔍 故障排除

### 常见问题

**1. API密钥无效**
```
错误：Invalid API key
解决：检查API密钥是否正确，是否有足够的配额
```

**2. 网络连接失败**
```
错误：Network error
解决：检查网络连接，确认API服务可访问
```

**3. 提示词过长**
```
错误：Token limit exceeded
解决：减少提示词长度或增加max_tokens参数
```

**4. 生成内容不符合预期**
```
解决：调整temperature参数或优化提示词
```

### 调试模式
```env
DEBUG=true
LOG_LEVEL=debug
```

## 📚 最佳实践

### 1. 提示词优化
- 使用具体的指令而非模糊的描述
- 提供清晰的输出格式要求
- 包含示例或模板
- 定期测试和调整

### 2. 性能优化
- 选择合适的模型（平衡质量和成本）
- 设置合理的Token限制
- 使用缓存减少重复请求
- 监控API使用量

### 3. 安全考虑
- 不要在代码中硬编码API密钥
- 使用环境变量管理敏感信息
- 定期轮换API密钥
- 限制API访问权限

## 🆘 获取帮助

如果遇到问题，可以：
1. 查看控制台错误日志
2. 检查环境变量配置
3. 测试API连接
4. 参考本文档的故障排除部分

---

**注意：** 修改配置后需要重启服务器才能生效。
